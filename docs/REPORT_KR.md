# β–οΈ D-HASH: λ¶„μ‚° μΊμ‹ λ΅λ“ λ°Έλ°μ‹±μ„ μ„ν• λ™μ  Hot-key λ€μ‘ ν•΄μ‹±

> "λ¶„μ‚° μΊμ‹ μ‹μ¤ν…μ Hot-key λ³‘λ© ν„μƒμ„ ν•΄κ²°ν•λ” ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ λ™μ  λΌμ°ν… μ•κ³ λ¦¬μ¦"

<p>
  <img src="https://img.shields.io/badge/Python-3.11-3776AB?style=flat-square&logo=python&logoColor=white"/>
  <img src="https://img.shields.io/badge/Redis-7.4.2-DC382D?style=flat-square&logo=redis&logoColor=white"/>
  <img src="https://img.shields.io/badge/Docker-2496ED?style=flat-square&logo=docker&logoColor=white"/>
  <img src="https://img.shields.io/badge/License-MIT-green?style=flat-square"/>
</p>

## π“„ λ…Όλ¬Έ μ •λ³΄
* μ λ©: D-HASH: Dynamic Hot-key Aware Scalable Hashing for Load Balancing in Distributed Cache Systems
* μ €μ: λ°©ν, μ „μƒν› (μμ›λ€ν•™κµ μ •λ³΄λ³΄νΈν•™κ³Ό)
* κ²μ¬: KSII TIIS 2026 (SCIE λ“±μ¬)
* DOI: [10.3837/tiis.2026.xx.xxx](https://doi.org/10.3837/tiis.2026.xx.xxx)

<br>

## π“‹ λ©μ°¨
1. [ν”„λ΅μ νΈ μ†κ°](#1-ν”„λ΅μ νΈ-μ†κ°)
2. [μ‹μ¤ν… κµ¬μ΅°](#2-μ‹μ¤ν…-κµ¬μ΅°)
3. [ν•µμ‹¬ μ•κ³ λ¦¬μ¦](#3-ν•µμ‹¬-μ•κ³ λ¦¬μ¦)
4. [μ‹¤ν— ν™κ²½](#4-μ‹¤ν—-ν™κ²½)
5. [μ‹¤ν–‰ λ°©λ²•](#5-μ‹¤ν–‰-λ°©λ²•)
6. [μ‹¤ν— κ²°κ³Ό](#6-μ‹¤ν—-κ²°κ³Ό)
7. [νΈλ¬λΈ” μν…](#7-νΈλ¬λΈ”-μν…)
8. [ν•κ³„ λ° ν–¥ν›„ κ³Όμ ](#8-ν•κ³„-λ°-ν–¥ν›„-κ³Όμ )

<br>

## 1. ν”„λ΅μ νΈ μ†κ°

### λ°°κ²½
λ€κ·λ¨ μΊμ‹ μ‹μ¤ν…μ—μ„ λ„λ¦¬ μ“°μ΄λ” Consistent Hashing λ°©μ‹μ€ λ°μ΄ν„°λ¥Ό λ…Έλ“μ— κ³¨κ³ λ£¨ λ‚λ„λ” λ°λ” ν¨κ³Όμ μ…λ‹λ‹¤. ν•μ§€λ§ νΉμ • λ°μ΄ν„°(Hot-key) μμ²΄μ— νΈλν”½μ΄ λ°λ¦¬λ” λ¬Έμ λ” ν•΄κ²°ν•μ§€ λ»ν•©λ‹λ‹¤.
μ‹¤μ  NASA μ›Ή λ΅κ·Έλ¥Ό λ¶„μ„ν•΄ λ³΄λ‹, μƒμ„ 1%μ λ°μ΄ν„°κ°€ μ „μ²΄ μ”μ²­μ 40% μ΄μƒμ„ μ°¨μ§€ν–μµλ‹λ‹¤. μ΄ λ•λ¬Έμ— νΉμ • μ„λ²„λ§ κ³Όλ¶€ν•κ°€ κ±Έλ ¤ μ „μ²΄ μ‹μ¤ν…μ΄ λλ ¤μ§€λ” λ¬Έμ κ°€ λ°μƒν•©λ‹λ‹¤.

### λ©ν‘
μ„λ²„ κµ¬μ΅°λ¥Ό λ°”κΎΈκ±°λ‚ λΉ„μ‹Ό ν”„λ΅μ‹ μ„λ²„λ¥Ό λ‘μ§€ μ•κ³ , ν΄λΌμ΄μ–ΈνΈ(SDK) μ½”λ“ μμ •λ§μΌλ΅ Hot-keyλ¥Ό μ‹¤μ‹κ°„μΌλ΅ κ°μ§€ν•κ³  νΈλν”½μ„ λ¶„μ‚°μ‹ν‚¤λ” κ²½λ‰ μ•κ³ λ¦¬μ¦(D-HASH)μ„ κµ¬ν„ν–μµλ‹λ‹¤.

<br>

## 2. μ‹μ¤ν… κµ¬μ΅°

![System Architecture](images/dhash_architecture.png)  
*(D-HASH μ „μ²΄ μ‹μ¤ν… κµ¬μ΅°λ„)*

### κµ¬μ„± μ”μ†
1.  κΈ°λ³Έ κ³„μΈµ: μΌλ°μ μΈ Consistent Hashing λ§ (κ°€μƒ λ…Έλ“ ν¬ν•¨)
2.  κ°μ§€ κ³„μΈµ: ν΄λΌμ΄μ–ΈνΈ λ‚΄λ¶€μ—μ„ LRU μΉ΄μ΄ν„°λ΅ λ°μ΄ν„° μ”μ²­ λΉλ„ μΈ΅μ •
3.  λΌμ°ν… κ³„μΈµ: νΉμ • ν‚¤κ°€ Hot-keyλ΅ νλ‹¨λλ©΄ λ™μ μΌλ΅ κ²½λ΅λ¥Ό λ³€κ²½ν•λ” λ΅μ§

### λ°μ΄ν„° μ²λ¦¬ μ „λµ
* μΌλ° ν‚¤: κΈ°μ΅΄μ²λΌ ν•΄μ‹κ°’μ— λ§λ” λ©”μΈ λ…Έλ“(Primary)λ΅ λ³΄λƒ…λ‹λ‹¤.
* Hot-key (μ½κΈ°): λ©”μΈ λ…Έλ“μ™€ λ€μ²΄ λ…Έλ“(Alternate)λ΅ νΈλν”½μ„ λ°λ°μ”© λ‚λ•λ‹λ‹¤.
* Hot-key (μ“°κΈ°): λ°μ΄ν„°κ°€ κΌ¬μ΄μ§€ μ•λ„λ΅ λ©”μΈ λ…Έλ“μ—λ§ κΈ°λ΅ν•©λ‹λ‹¤.

<br>

## 3. ν•µμ‹¬ μ•κ³ λ¦¬μ¦

### κ°μ§€ λ° μΉκ²©
μ–΄λ–¤ ν‚¤μ μ΅°νμκ°€ μ •ν•΄μ§„ μ„κ³„κ°’($T$)μ„ λ„μΌλ©΄ Hot-keyλ΅ 'μΉκ²©'μ‹ν‚µλ‹λ‹¤. μ΄λ• λ°”λ΅ λ¶„μ‚°μ‹ν‚¤λ©΄ λ€μ²΄ λ…Έλ“μ— λ°μ΄ν„°κ°€ μ—†μ–΄ μ—λ¬(Cache Miss)κ°€ λ‚  μ μμΌλ―€λ΅, μ μ‹ λ°μ΄ν„°λ¥Ό μ±„μ›μ£Όλ” μμ—΄ μ‹κ°„(Guard Phase)μ„ κ°€μ§‘λ‹λ‹¤.

~~~python
# LRU μΉ΄μ΄ν„° λ΅μ§
if read_count[key] > THRESHOLD:
    promote_to_hotkey(key)  # Hot-keyλ΅ μΉκ²©
    enter_guard_phase(key)  # μμ—΄ μ‹μ‘ (λ€μ²΄ λ…Έλ“μ—λ„ λ°μ΄ν„° μ €μ¥)
~~~

### μλ„μ° κΈ°λ° λΌμ°ν…
Hot-keyλ΅ μΉκ²©λ λ°μ΄ν„°λ” μ”μ²­ νμμ— λ”°λΌ λ©”μΈ λ…Έλ“μ™€ λ€μ²΄ λ…Έλ“λ΅ λ²κ°μ•„ λ³΄λƒ…λ‹λ‹¤.

~~~python
# κ²°μ •λ΅ μ  λΌμ°ν… (λλ¤ μ•„λ‹)
window_id = request_count // WINDOW_SIZE

if window_id % 2 == 0:
    route_to_alternate_node(key) # μ§μ μλ„μ°: λ€μ²΄ λ…Έλ“
else:
    route_to_primary_node(key)   # ν™€μ μλ„μ°: λ©”μΈ λ…Έλ“
~~~
* μ„κ³„κ°’ ($T$): 300ν (μ‹¤ν—μ„ ν†µν•΄ κµ¬ν• μµμ κ°’)
* μλ„μ° ν¬κΈ° ($W$): 1,000ν

<br>

## 4. μ‹¤ν— ν™κ²½

* ν•λ“μ›¨μ–΄: Intel Core i5-1340P, 16GB RAM
* μ†ν”„νΈμ›¨μ–΄: Docker (WSL2), Redis 7.4.2
* ν΄λΌμ΄μ–ΈνΈ: Python 3.11 (`redis-py` λΌμ΄λΈλ¬λ¦¬ ν™•μ¥)
* λ°μ΄ν„°μ…‹:
    1.  NASA HTTP Logs: μ‹¤μ  μ›Ή νΈλν”½ λ°μ΄ν„°
    2.  Synthetic Zipfian: μΈμ„μ μΌλ΅ μ λ¦Ό ν„μƒμ„ κ·Ήλ€ν™”ν• λ°μ΄ν„° ($\alpha=1.5$)

<br>

## 5. μ‹¤ν–‰ λ°©λ²•

### μ‚¬μ „ μ¤€λΉ„
* Docker λ° Docker Compose μ„¤μΉ

### λ²¤μΉλ§ν¬ μ‹¤ν–‰
~~~bash
# 1. μ €μ¥μ† λ‹¤μ΄λ΅λ“
git clone https://github.com/yourusername/dhash.git
cd dhash

# 2. μ»¨ν…μ΄λ„ λΉλ“ λ° μ‹¤ν–‰ (Redis λ…Έλ“ + λ²¤μΉλ§ν¬ ν΄)
docker-compose up --build

# 3. μ‹¤μ‹κ°„ λ΅κ·Έ ν™•μΈ
docker-compose logs -f runner
~~~

### κ²°κ³Ό ν™•μΈ
μ‹¤ν— κ²°κ³Όλ” `./results` ν΄λ”μ— CSV νμΌλ΅ μ €μ¥λ©λ‹λ‹¤.
* `synthetic_zipf_results.csv`: λ©”μΈ μ„±λ¥ κ²°κ³Ό
* `synthetic_ablation.csv`: νλΌλ―Έν„° ν…μ¤νΈ κ²°κ³Ό

<br>

## 6. μ‹¤ν— κ²°κ³Ό

### NASA λ°μ΄ν„°μ…‹ (μ‹¤μ  ν™κ²½)
| μ•κ³ λ¦¬μ¦ | μ²λ¦¬λ‰ (ops/s) | λ¶€ν• ν‘μ¤€νΈμ°¨ (λ‚®μ„μλ΅ μΆ‹μ) | κ°μ„ μ¨ |
|:---|:---:|:---:|:---:|
| Consistent Hashing | 159,608 | 725,757 | - |
| D-HASH | 159,927 | 531,824 | π”» 26.7% κ°μ„  |

### Zipf λ¶„ν¬ λ°μ΄ν„° (κ·Ήν• ν™κ²½)
| μ•κ³ λ¦¬μ¦ | μ²λ¦¬λ‰ (ops/s) | λ¶€ν• ν‘μ¤€νΈμ°¨ (λ‚®μ„μλ΅ μΆ‹μ) | κ°μ„ μ¨ |
|:---|:---:|:---:|:---:|
| Consistent Hashing | 179,902 | 49,944 | - |
| D-HASH | 167,092 | 33,054 | π”» 33.8% κ°μ„  |

κ²°λ΅ : μ•½ 7% μ •λ„μ μ²λ¦¬ μ†λ„ μ €ν•λ” μμ—μ§€λ§, μ„λ²„ κ°„ λ¶€ν• λ¶κ· ν•μ„ 33.8%λ‚ μ¤„μ—¬μ„ μ‹μ¤ν…μ΄ ν›¨μ”¬ μ•μ •μ μΌλ΅ λμ•„κ°€κ² λ§λ“¤μ—μµλ‹λ‹¤.

<br>

## 7. νΈλ¬λΈ” μν…

### 1. xxHash64μ™€ \_\_slots\_\_λ¥Ό ν™μ©ν• μ‹λ®¬λ μ΄μ… μ„±λ¥ μµμ ν™”
[π‘‰ ν¬μ¤νΈ λ³΄λ¬κ°€κΈ°](https://bh1848.github.io/hzeror/D-HASH-xxhash/)

- **Situation**: λ€κ·λ¨ λ¶„μ‚° μ‹λ®¬λ μ΄μ… μ‹ MD5μ λ†’μ€ μ—°μ‚° λΉ„μ©μΌλ΅ μ²λ¦¬λ‰μ΄ κΈ‰κ°ν•κ³ , Python κ°μ²΄ μ¤λ²„ν—¤λ“λ΅ μΈν•΄ λ©”λ¨λ¦¬ μ μ μ¨μ΄ ν•κ³„μ— λ„λ‹¬.
- **Task**: μλ°±λ§ κ°μ ν‚¤μ™€ λ…Έλ“λ¥Ό μμ©ν•  μ μλ„λ΅ μ‹λ®¬λ μ΄ν„°μ μ—°μ‚° μ†λ„ λ° λ©”λ¨λ¦¬ ν¨μ¨ μµμ ν™”.
- **Action**: μ•”νΈν•™μ  ν•΄μ‹μΈ MD5λ¥Ό λΉ„μ•”νΈν™” κ³ μ† ν•΄μ‹μΈ xxHash64λ΅ λ€μ²΄ν•κ³ , Python ν΄λμ¤μ— `__slots__`λ¥Ό μ μ©ν•μ—¬ λ™μ  λ”•μ…”λ„λ¦¬ μƒμ„±μ„ μ°¨λ‹¨.
- **Result**: ν•΄μ‹± μ—°μ‚° μ†λ„ 20λ°° ν–¥μƒ λ° κ°μ²΄λ‹Ή λ©”λ¨λ¦¬ μ‚¬μ©λ‰ 50% μ κ°μ„ ν†µν•΄ λ€κ·λ¨ μ‹λ‚λ¦¬μ¤ ν…μ¤νΈ κ°€λ¥ ν™κ²½ ν™•λ³΄.

### 2. Hot-key μΉκ²© μ‹μ μ Latency Spike μ–µμ  (Guard Phase)
[π‘‰ ν¬μ¤νΈ λ³΄λ¬κ°€κΈ°](https://bh1848.github.io/hzeror/D-HASH-guard-phase/)

- **Situation**: νΉμ • ν‚¤κ°€ Hot-keyλ΅ μΉκ²©λμ–΄ λ€μ²΄ λ…Έλ“(Alternate Node)λ΅ νΈλν”½μ΄ μ „ν™λλ” μκ°„, μΊμ‹κ°€ λΉ„μ–΄μλ” 'Cold Start' μƒνƒλ΅ μΈν•΄ μ‘λ‹µ μ§€μ—°(Latency Spike) λ°μƒ.
- **Task**: λ™μ  λΌμ°ν… μ „ν™ μ‹μ μ μΊμ‹ λ―Έμ¤λ¥Ό λ°©μ§€ν•κ³  λ¶€ν• λ¶„μ‚°μ μ•μ •μ„± ν™•λ³΄.
- **Action**: μΉκ²© μ§ν›„ μΌμ • κΈ°κ°„ νΈλν”½μ„ μ μ§€ν•λ” Guard Phaseμ™€, μ“°κΈ° μ”μ²­μ„ λ€μ²΄ λ…Έλ“μ—λ„ λΉ„λ™κΈ°λ΅ λ³µμ ν•λ” Pre-warming(μ΄μ¤‘ μ“°κΈ°) μ „λµ μ„¤κ³„.
- **Result**: μΉκ²© κµ¬κ°„μ κΈ‰κ²©ν• μ„±λ¥ μ €ν•λ¥Ό μ°¨λ‹¨ν•κ³ , Zipfian μ›ν¬λ΅λ“ ν™κ²½μ—μ„ λ¶€ν• ν‘μ¤€νΈμ°¨λ¥Ό μµλ€ 33.8% κ°μ„ .

### 3. λ¶„μ‚° μΊμ‹ μ •ν•©μ„± μ μ§€λ¥Ό μ„ν• Write-Primary λΌμ°ν… μ„¤κ³„
[π‘‰ ν¬μ¤νΈ λ³΄λ¬κ°€κΈ°](https://bh1848.github.io/hzeror/D-HASH-routing-strategy/)

- **Situation**: μ½κΈ° νΈλν”½ λ¶„μ‚°μ„ μ„ν• λ™μ  λΌμ°ν… κ·μΉ™μ„ μ“°κΈ° μ”μ²­μ—λ„ λ™μΌν•κ² μ μ©ν•  κ²½μ°, λ…Έλ“ κ°„ λ°μ΄ν„° ννΈν™”(Fragmentation) λ° μ •ν•©μ„± λ¶μΌμΉ μ„ν‘ ν™•μΈ.
- **Task**: λ™μ  λ΅λ“ λ°Έλ°μ‹± ν™κ²½μ—μ„λ„ λ°μ΄ν„°μ λ¬΄κ²°μ„±(Consistency)μ„ μ™„λ²½ν•κ² λ³΄μ¥ν•λ” μ•„ν‚¤ν…μ² μλ¦½.
- **Action**: μ½κΈ° μ”μ²­μ€ λ¶€ν•μ— λ”°λΌ κ²½λ΅λ¥Ό λ¶„κΈ°ν•λ, μ“°κΈ° μ”μ²­μ€ λ¶λ³€μ ν•΄μ‹ λ§μ΄ μ§€μ •ν• μ£Ό λ…Έλ“(p(k))λ΅λ§ κ³ μ •ν•λ” Write-Primary ν¨ν„΄ λ„μ….
- **Result**: λ³µμ΅ν• λ¶„μ‚° λ½(Distributed Lock) μ—†μ΄λ„ λ°μ΄ν„° ννΈν™” 0%λ¥Ό λ‹¬μ„±ν•λ©° μ‹μ¤ν…μ λ³µμ΅λ„μ™€ μ •ν•©μ„± λ¬Έμ λ¥Ό λ™μ‹μ— ν•΄κ²°.

### 4. ν΄λΌμ΄μ–ΈνΈ λ³‘λ© ν•΄μ†λ¥Ό μ„ν• λΉ„λ™κΈ° λ²¤μΉλ§ν¬ ν™κ²½ κµ¬μ¶•
[π‘‰ ν¬μ¤νΈ λ³΄λ¬κ°€κΈ°](https://bh1848.github.io/hzeror/D-HASH-threadpoolexecutor/)

- **Situation**: λ™κΈ°μ‹(Blocking I/O) λ¶€ν• ν…μ¤νΈ μν–‰ μ¤‘, μ„λ²„ μμ›μ€ μ¶©λ¶„ν•¨μ—λ„ ν΄λΌμ΄μ–ΈνΈμ λ„¤νΈμ›ν¬ λ€κΈ° μ‹κ°„(RTT)μΌλ΅ μΈν•΄ μ²λ¦¬λ‰(Throughput)μ΄ μ •μ²΄λλ” λ³‘λ© ν„μƒ λ°μƒ.
- **Task**: λ„¤νΈμ›ν¬ μ§€μ—°μ„ λ°°μ ν•κ³  μ„λ²„μ μμ μµλ€ μ²λ¦¬λ‰(OPS)μ„ κ²€μ¦ν•  μ μλ” λ…ΌλΈ”λ΅ν‚Ή ν…μ¤νΈ ν™κ²½ κµ¬μ¶•.
- **Action**: Python `ThreadPoolExecutor`λ¥Ό λ„μ…ν•μ—¬ μ”μ²­μ„ λ³‘λ ¬ν™”ν•κ³ , λ…Έλ“λ³„ λ²„ν‚·ν…(Bucketing)μ„ ν†µν•΄ λ½ κ²½ν•©μ„ μµμ†ν™”ν• λΉ„λ™κΈ° λ²¤μΉλ§ν¬ ν΄ κ°λ°.
- **Result**: κΈ°μ΅΄ λ€λΉ„ μ••λ„μ μΈ 180,000 OPSλ¥Ό λ‹¬μ„±ν•μ—¬ μ‹¤μ  μ΄μ ν™κ²½ μμ¤€μ μ„±λ¥μ„ κ²€μ¦ν•κ³ , Tail Latency(P99) μΈ΅μ •μ μ •λ°€λ„ ν™•λ³΄.

<br>

## 8. ν•κ³„ λ° ν–¥ν›„ κ³Όμ 

### ν„μ¬μ ν•κ³„
1.  μ‹μ•Ό μ ν•: κ° ν΄λΌμ΄μ–ΈνΈκ°€ νΌμμ„λ§ μΉ΄μ΄ν…μ„ ν•λ―€λ΅, μ „μ²΄ μ‹μ¤ν… μƒν™©μ„ μ™„λ²½ν•κ² μ‹¤μ‹κ°„μΌλ΅ μ• μλ” μ—†μµλ‹λ‹¤.
2.  κ°•λ“± λ΅μ§ λ¶€μ¬: Hot-keyκ°€ μ‹μ—μ„ λ• λ‹¤μ‹ μΌλ° ν‚¤λ΅ λλ¦¬λ” κΈ°λ¥μ΄ μ•„μ§ μ—†μµλ‹λ‹¤.
3.  λ„¤νΈμ›ν¬ ν™κ²½: λ„μ»¤ λ‚΄λ¶€ ν†µμ‹ μ΄λΌ μ‹¤μ  μΈν„°λ„·λ§μ μ§€μ—° μ‹κ°„(Jitter)κΉμ§€λ” λ°μν•μ§€ λ»ν–μµλ‹λ‹¤.

### ν–¥ν›„ κ³„ν
* μλ™ κ°•λ“±: μ‹κ°„μ΄ μ§€λ‚λ©΄ μΉ΄μ΄νΈλ¥Ό μ¤„μ΄λ” μ•κ³ λ¦¬μ¦μ„ λ„£μ–΄, μ• μ“°λ” Hot-keyλ¥Ό ν•΄μ ν•λ” κΈ°λ¥ μ¶”κ°€.
* μ •λ³΄ κ³µμ : ν΄λΌμ΄μ–ΈνΈλΌλ¦¬ Hot-key μ •λ³΄λ¥Ό μ£Όκ³ λ°›λ” ν”„λ΅ν† μ½(Gossip) κµ¬ν„.
* ν΄λΌμ°λ“ κ²€μ¦: AWS κ°™μ€ μ‹¤μ  ν΄λΌμ°λ“ ν™κ²½μ—μ„ ν…μ¤νΈ μ§„ν–‰.
